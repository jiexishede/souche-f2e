function createBrandsManager(e){var a=e,r={brands:{},toggleSeries:function(e,r,t){var n=this.brands,s=n[e];if(s&&s[r])this.removeSeries(e,r),$.isEmptyObject(n)&&a.hide();else{if($.isEmptyObject(n)&&a.show(),s=n[e]=n[e]||{},""==r)for(var i in s)this.removeSeries(e,i);else this.removeSeries(e,"");this.addSeries(e,r,t)}},removeSeries:function(e,a){var r=this.brands[e];if(a in r){var t=r[a];t[0].remove(),t[1].removeClass("selected"),delete r[a],$.isEmptyObject(r)&&delete this.brands[e]}},addSeries:function(e,r,t){var n=this.brands,s=n[e]=n[e]||{};s[r]=t,a.append(t[0]),t[1].addClass("selected")}};return r}function gotoPage(e){pageStack.push(curPageIndex),e=e||curPageIndex+1,document.body.scrollTop=0;var a=pages[curPageIndex-1],r=pages[e-1];r.css({left:"100%"}).show(),a.animate({left:"-100%"},function(){a.hide()}),r.animate({left:"0"}),curPageIndex=e}function backPage(){document.body.scrollTop=0;var e=pageStack.pop();if(0==e)return void history.back();var a=pages[curPageIndex-1],r=pages[e-1];r.css({left:"-100%"}).show(),a.animate({left:"100%"},function(){a.hide()}),r.animate({left:"0"}),curPageIndex=e}var brandsManager=createBrandsManager($(".selected-brand")),curPageIndex=1,pageStack=[];pageStack.push(0);var pages=[$("#page-1"),$("#page-2"),$("#page-3")];$("#page-1,#page-2 .next-btn").click(function(){gotoPage()}),$(".back-icon").click(function(){backPage()}),$(".selected-brand").on("click",".close-icon",function(){for(var e,a=$(this).parent();a;){if(a.hasClass("sb-item")){e=a;break}a=a.parent()}var r=e.attr("brand-code"),t=e.attr("series-code");brandsManager.toggleSeries(r,t)});var $curBrandArray,$curFold,curBrandCode;$(".icon-item").click(function(){var e=$(this),a=e.attr("data-code");if(curBrandCode!==a&&($curFold&&($curFold.hide(),$curBrandArray.hide()),a)){var r=e.attr("data-index");curBrandCode=e.attr("data-code"),$curFold=e.siblings(".fold-series[data-index="+r+"]"),$curBrandArray=e.find(".brand-array"),$curFold.slideDown(500,function(){$curBrandArray.show()})}}),$("#more-brand").click(function(){}),$(".series-item").click(function(){var e=($(this).attr("data-index"),$(this).attr("data-code")),a=$(this).find(".text"),r=a.text(),t='<div class="sb-item" brand-code='+curBrandCode+" series-code="+e+'><span class="text">'+r+'</span><i class="close-icon"></i></div>';brandsManager.toggleSeries(curBrandCode,e,[$(t),a])}),$(".year-item").click(function(){$(".year-item .text").removeClass("selected"),$(this).find(".text").addClass("selected")});